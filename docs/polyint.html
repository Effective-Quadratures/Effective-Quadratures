<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quadrature rules &#8212;   v6.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'v6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="  v6.0 documentation" href="index.html" />
    <link rel="up" title="Coefficient computation" href="polychildren.html" />
    <link rel="next" title="Compressive sensing" href="polycs.html" />
    <link rel="prev" title="Regression" href="polyreg.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-inverse navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/logo.png"></span>
           </a>
        <span class="navbar-text navbar-version pull-left"><b>v6.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">  <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="corecode.html">Core code</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="parameter.html">Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="basis.html">Basis</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="poly.html">Polynomials</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributions.html">Probability distributions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dr.html">Dimension reduction utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="convex.html">Convex optimization utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html">Statistics utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Plotting utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Quadrature rules</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="polyreg.html" title="Previous Chapter: Regression"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Regression</span>
    </a>
  </li>
  <li>
    <a href="polycs.html" title="Next Chapter: Compressive sensing"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Compressive s... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/polyint.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="module-equadratures.polyint">
<span id="quadrature-rules"></span><h1>Quadrature rules<a class="headerlink" href="#module-equadratures.polyint" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt>Operations involving multivariate polynomials (without gradients) via numerical quadrature. The following quadrature techniques are available for coefficient computation:</dt>
<dd><ol class="first last arabic simple">
<li>Tensor grids;</li>
<li>Sparse pseudospectral approximation method;</li>
<li>Effectively subsampled quadratures (both QR and SVD);</li>
<li>Christoffel subsamples;</li>
<li>Induced subsamples;</li>
<li>Randomized quadrature.</li>
</ol>
</dd>
<dt>References:</dt>
<dd><ul class="first last simple">
<li>Seshadri, P., Narayan, A., &amp; Mahadevan, S. (2017). Effectively Subsampled Quadratures for Least Squares Polynomial Approximations. SIAM/ASA Journal on Uncertainty Quantification, 5(1), 1003-1023. <a class="reference external" href="https://epubs.siam.org/doi/abs/10.1137/16M1057668">Paper</a>.</li>
<li>Constantine, P. G., Eldred, M. S., &amp; Phipps, E. T. (2012). Sparse pseudospectral approximation method. Computer Methods in Applied Mechanics and Engineering, 229, 1-12. <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0045782512000953">Paper</a>.</li>
<li>Zhou, T., Narayan, A., &amp; Xiu, D. (2015). Weighted discrete least-squares polynomial approximation using randomized quadratures. Journal of Computational Physics, 298, 787-800. <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0021999115004404">Paper</a>.</li>
<li>Narayan, A., Jakeman, J., &amp; Zhou, T. (2017). A Christoffel function weighted least squares algorithm for collocation approximations. Mathematics of Computation, 86(306), 1913-1947. <a class="reference external" href="http://www.ams.org/journals/mcom/2017-86-306/S0025-5718-2016-03192-0/home.html">Paper</a>.</li>
</ul>
</dd>
</dl>
<dl class="class">
<dt id="equadratures.polyint.Polyint">
<em class="property">class </em><code class="descclassname">equadratures.polyint.</code><code class="descname">Polyint</code><span class="sig-paren">(</span><em>parameters</em>, <em>basis</em>, <em>sampling=None</em>, <em>fun=None</em><span class="sig-paren">)</span><a class="headerlink" href="#equadratures.polyint.Polyint" title="Permalink to this definition">¶</a></dt>
<dd><p>This class defines a Polyint (polynomial via integration) object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parameters</strong> (<a class="reference internal" href="parameter.html#equadratures.parameter.Parameter" title="equadratures.parameter.Parameter"><em>Parameter</em></a>) &#8211; A list of parameters.</li>
<li><strong>basis</strong> (<a class="reference internal" href="basis.html#equadratures.basis.Basis" title="equadratures.basis.Basis"><em>Basis</em></a>) &#8211; A basis selected for the multivariate polynomial.</li>
<li><strong>sampling</strong> (<em>string</em>) &#8211; The sampling technique. Choose from: &#8216;tensor grid quadrature&#8217; (default), &#8216;sparse grid quadrature&#8217;, &#8216;effectively subsampled quadrature&#8217;, &#8216;Christoffel subsamples&#8217;, &#8216;Induced subsamples&#8217; and &#8216;randomized quadrature&#8217;.</li>
<li><strong>fun</strong> (<em>callable</em>) &#8211; Instead of specifying the output training points, the user can also provide a callable function, which will be evaluated.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="equadratures.polyint.Polyint.getPolynomialCoefficients">
<code class="descname">getPolynomialCoefficients</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="headerlink" href="#equadratures.polyint.Polyint.getPolynomialCoefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns multivariate orthonormal polynomial coefficients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>self</strong> (<a class="reference internal" href="#equadratures.polyint.Polyint" title="equadratures.polyint.Polyint"><em>Polyint</em></a>) &#8211; An instance of the Polyint class</td>
</tr>
<tr class="field-even field"><th class="field-name">Param:</th><td class="field-body">callable function: The function that needs to be approximated (or interpolated)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">coefficients: The pseudospectral coefficients</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">indexset: The indices used for the pseudospectral computation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">evaled_pts: The points at which the function was evaluated</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="equadratures.polyint.Polyint.setSamplingMethod">
<em class="property">static </em><code class="descname">setSamplingMethod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#equadratures.polyint.Polyint.setSamplingMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>This function sets the quadrature method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>self</strong> (<a class="reference internal" href="#equadratures.polyint.Polyint" title="equadratures.polyint.Polyint"><em>Polyint</em></a>) &#8211; An instance of the Polyint class.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="equadratures.polyint.sparsegrid">
<code class="descclassname">equadratures.polyint.</code><code class="descname">sparsegrid</code><span class="sig-paren">(</span><em>stackOfParameters</em>, <em>level</em>, <em>growth_rule</em>, <em>function=None</em><span class="sig-paren">)</span><a class="headerlink" href="#equadratures.polyint.sparsegrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a sparse grid of quadrature points based on the distributions for each Parameter in stackOfParameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array stackOfParameters</strong> (<a class="reference internal" href="parameter.html#equadratures.parameter.Parameter" title="equadratures.parameter.Parameter"><em>Parameter</em></a>) &#8211; A list of Parameter objects</li>
<li><strong>level</strong> (<em>integer</em>) &#8211; Level parameter of the sparse grid integration rule</li>
<li><strong>growth_rule</strong> (<em>string</em>) &#8211; Growth rule for the sparse grid. Choose from &#8216;linear&#8217; or &#8216;exponential&#8217;.</li>
<li><strong>function</strong> (<em>callable</em>) &#8211; The function whose integral needs to be computed. Can also be input as an array of function values at the
quadrature points. If the function is given as a callable, then this routine outputs the integral of the function and an array of
the points at which the function was evaluated at to estimate the integral. These are the quadrature points. In case the function is
not given as a callable (or an array, for that matter), then this function outputs the quadrature points and weights.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">sparse_int: The sparse grid approximation of the integral</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">double</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">points:  The quadrature points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy ndarray</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">weights: The quadrature weights</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="equadratures.polyint.tensorgrid">
<code class="descclassname">equadratures.polyint.</code><code class="descname">tensorgrid</code><span class="sig-paren">(</span><em>stackOfParameters</em>, <em>function=None</em><span class="sig-paren">)</span><a class="headerlink" href="#equadratures.polyint.tensorgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a tensor grid of quadrature points based on the distributions for each Parameter in stackOfParameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array stackOfParameters</strong> (<a class="reference internal" href="parameter.html#equadratures.parameter.Parameter" title="equadratures.parameter.Parameter"><em>Parameter</em></a>) &#8211; A list of Parameter objects</li>
<li><strong>function</strong> (<em>callable</em>) &#8211; The function whose integral needs to be computed. Can also be input as an array of function values at the
quadrature points. If the function is given as a callable, then this routine outputs the integral of the function and an array of
the points at which the function was evaluated at to estimate the integral. These are the quadrature points. In case the function is
not given as a callable (or an array, for that matter), then this function outputs the quadrature points and weights.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tensor_int: The tensor grid approximation of the integral</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">double</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">points:  The quadrature points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy ndarray</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">weights: The quadrature weights</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy ndarray</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Notes</strong>
For further details on this routine, see Polynomial.getPointsAndWeights()</p>
</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016-2018 by Effective Quadratures.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>